(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{8210:function(e,t,l){Promise.resolve().then(l.bind(l,9504))},9504:function(e,t,l){"use strict";let a,o,n;l.r(t),l.d(t,{default:function(){return B}});var r=l(7437),s=l(2265);let i=e=>{let t;let l=new Set,a=(e,a)=>{let o="function"==typeof e?e(t):e;if(!Object.is(o,t)){let e=t;t=(null!=a?a:"object"!=typeof o||null===o)?o:Object.assign({},t,o),l.forEach(l=>l(t,e))}},o=()=>t,n={setState:a,getState:o,getInitialState:()=>r,subscribe:e=>(l.add(e),()=>l.delete(e))},r=t=e(a,o,n);return n},c=e=>e?i(e):i,d=e=>e,u=e=>{let t=c(e),l=e=>(function(e,t=d){let l=s.useSyncExternalStore(e.subscribe,s.useCallback(()=>t(e.getState()),[e,t]),s.useCallback(()=>t(e.getInitialState()),[e,t]));return s.useDebugValue(l),l})(t,e);return Object.assign(l,t),l},x=e=>t=>{try{let l=e(t);if(l instanceof Promise)return l;return{then:e=>x(e)(l),catch(e){return this}}}catch(e){return{then(e){return this},catch:t=>x(t)(e)}}},b=["#6366f1","#ec4899","#f59e0b","#10b981","#3b82f6","#ef4444","#8b5cf6","#06b6d4","#f97316","#84cc16"],p=()=>"node_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),g=e=>({id:p(),parentId:null,position:{x:0,y:0},collapsed:!1,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),...e}),f=()=>{let e=new Date().toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"}),t=g({label:"My Workspace",color:"#6366f1",isRoot:!0}),l=g({label:"Design System",color:"#ec4899",parentId:t.id,position:{x:320,y:-160}}),a=g({label:"Backend API",color:"#10b981",parentId:t.id,position:{x:320,y:160}}),o=g({label:"Create color palette",color:"#ec4899",parentId:l.id,position:{x:620,y:-260},status:"done",priority:"normal"}),n=g({label:"Design components",color:"#ec4899",parentId:l.id,position:{x:620,y:-160},status:"doing",priority:"high"}),r=g({label:"Build auth endpoints",color:"#10b981",parentId:a.id,position:{x:620,y:100},status:"todo",priority:"urgent",deadline:new Date(Date.now()-864e5).toISOString()}),s=g({label:"Database schema",color:"#10b981",parentId:a.id,position:{x:620,y:200},status:"doing",priority:"high"}),i=g({label:e,color:"#f59e0b",isRoot:!0}),c=g({label:"Morning",color:"#f59e0b",parentId:i.id,position:{x:-220,y:-200}}),d=g({label:"Afternoon",color:"#3b82f6",parentId:i.id,position:{x:220,y:-200}}),u=g({label:"Evening",color:"#8b5cf6",parentId:i.id,position:{x:220,y:200}}),x=g({label:"Someday",color:"#6b7280",parentId:i.id,position:{x:-220,y:200}}),b=g({label:"Review PRs",color:"#f59e0b",parentId:c.id,position:{x:-420,y:-280},estimatedTime:30,completed:!1}),p=g({label:"Team standup",color:"#f59e0b",parentId:c.id,position:{x:-420,y:-180},estimatedTime:15,completed:!0}),f=g({label:"2024 Goals",color:"#6366f1",isRoot:!0}),m=g({label:"Revenue",color:"#10b981",parentId:f.id,position:{x:300,y:-200},targetValue:1e5,currentValue:67e3}),h=g({label:"Fitness",color:"#ec4899",parentId:f.id,position:{x:-300,y:-200},targetValue:50,currentValue:32}),y=g({label:"Learning",color:"#f59e0b",parentId:f.id,position:{x:0,y:280},targetValue:24,currentValue:18}),v=g({label:"Q3: $42K",color:"#10b981",parentId:m.id,position:{x:540,y:-260},targetValue:42e3,currentValue:42e3}),k=g({label:"Q4: $33K",color:"#10b981",parentId:m.id,position:{x:540,y:-160},targetValue:33e3,currentValue:25e3}),j=g({label:"My Knowledge",color:"#06b6d4",isRoot:!0}),N=g({label:"Development",color:"#3b82f6",parentId:j.id,position:{x:300,y:-200}}),w=g({label:"Product",color:"#ec4899",parentId:j.id,position:{x:-300,y:-200}}),D=g({label:"Business",color:"#10b981",parentId:j.id,position:{x:0,y:280}}),C=g({label:"React Patterns",color:"#3b82f6",parentId:N.id,position:{x:560,y:-280},notes:"Key React patterns: compound components, render props, custom hooks. Use composition over inheritance. Prefer controlled components for forms.",tags:["react","frontend"]}),S=g({label:"System Design",color:"#3b82f6",parentId:N.id,position:{x:560,y:-160},notes:"CAP theorem, distributed systems, load balancing. Design for failure. Use caching layers. Horizontal scaling preferred.",tags:["architecture","backend"]});return{tasks:{nodes:[t,l,a,o,n,r,s]},braindump:{nodes:[]},planner:{nodes:[i,c,d,u,x,b,p]},goals:{nodes:[f,m,h,y,v,k]},knowledge:{nodes:[j,N,w,D,C,S]},settings:{darkMode:!0,workspaceName:"My Workspace",autoSave:!0},recentNodeIds:[],version:"1.0.0"}},m=(a?u(a):u)((o=(e,t)=>({data:f(),activeMode:"tasks",selectedNodeId:null,editingNodeId:null,searchQuery:"",contextMenu:{visible:!1,x:0,y:0,nodeId:null},sidebarOpen:!0,filterState:{showOverdue:!1,showUrgent:!1,projectId:null},setActiveMode:t=>e({activeMode:t,selectedNodeId:null,editingNodeId:null}),addNode:function(l){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=p(),n=t().activeMode,r=t().data[n].nodes,s=l?r.find(e=>e.id===l):null,i=a.color||(null==s?void 0:s.color)||b[Math.floor(Math.random()*b.length)],c=r.filter(e=>e.parentId===l),d=(null==s?void 0:s.position)||{x:0,y:0},u=c.length,x={id:o,parentId:l,label:"New Node",color:i,position:a.position||{x:d.x+(l?240:0),y:d.y+(80*u-40*u)},collapsed:!1,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),...a};return e(e=>({data:{...e.data,[n]:{nodes:[...e.data[n].nodes,x]}},selectedNodeId:o,editingNodeId:o})),t().addRecentNode(o),o},updateNode:(l,a)=>{let o=t().activeMode;e(e=>({data:{...e.data,[o]:{nodes:e.data[o].nodes.map(e=>e.id===l?{...e,...a,updatedAt:new Date().toISOString()}:e)}}}))},deleteNode:l=>{let a=t().activeMode,o=(e,t)=>{let l=t.filter(t=>t.parentId===e);return[e,...l.flatMap(e=>o(e.id,t))]};e(e=>{let t=o(l,e.data[a].nodes);return{data:{...e.data,[a]:{nodes:e.data[a].nodes.filter(e=>!t.includes(e.id))}},selectedNodeId:e.selectedNodeId===l?null:e.selectedNodeId}})},setSelectedNode:t=>e({selectedNodeId:t}),setEditingNode:t=>e({editingNodeId:t}),setSearchQuery:t=>e({searchQuery:t}),setContextMenu:t=>e({contextMenu:t}),toggleSidebar:()=>e(e=>({sidebarOpen:!e.sidebarOpen})),updateSettings:t=>e(e=>({data:{...e.data,settings:{...e.data.settings,...t}}})),toggleDarkMode:()=>e(e=>({data:{...e.data,settings:{...e.data.settings,darkMode:!e.data.settings.darkMode}}})),setFilter:t=>e(e=>({filterState:{...e.filterState,...t}})),exportData:()=>{let e=new Blob([JSON.stringify(t().data,null,2)],{type:"application/json"}),l=URL.createObjectURL(e),a=document.createElement("a");a.href=l,a.download="mindflow-".concat(new Date().toISOString().split("T")[0],".json"),a.click(),URL.revokeObjectURL(l)},importData:t=>e({data:t}),addRecentNode:t=>e(e=>({data:{...e.data,recentNodeIds:[t,...e.data.recentNodeIds.filter(e=>e!==t)].slice(0,10)}})),getNodes:()=>t().data[t().activeMode].nodes,getNodeById:e=>{for(let l of["tasks","braindump","planner","goals","knowledge"]){let a=t().data[l].nodes.find(t=>t.id===e);if(a)return a}},getChildren:e=>t().getNodes().filter(t=>t.parentId===e)}),n={name:"mindflow-data",version:1},(e,t,l)=>{let a,r={storage:function(e,t){let l;try{l=e()}catch(e){return}return{getItem:e=>{var t;let a=e=>null===e?null:JSON.parse(e,void 0),o=null!=(t=l.getItem(e))?t:null;return o instanceof Promise?o.then(a):a(o)},setItem:(e,t)=>l.setItem(e,JSON.stringify(t,void 0)),removeItem:e=>l.removeItem(e)}}(()=>window.localStorage),partialize:e=>e,version:0,merge:(e,t)=>({...t,...e}),...n},s=!1,i=0,c=new Set,d=new Set,u=r.storage;if(!u)return o((...t)=>{console.warn(`[zustand persist middleware] Unable to update item '${r.name}', the given storage is currently unavailable.`),e(...t)},t,l);let b=()=>{let e=r.partialize({...t()});return u.setItem(r.name,{state:e,version:r.version})},p=l.setState;l.setState=(e,t)=>(p(e,t),b());let g=o((...t)=>(e(...t),b()),t,l);l.getInitialState=()=>g;let f=()=>{var l,o;if(!u)return;let n=++i;s=!1,c.forEach(e=>{var l;return e(null!=(l=t())?l:g)});let p=(null==(o=r.onRehydrateStorage)?void 0:o.call(r,null!=(l=t())?l:g))||void 0;return x(u.getItem.bind(u))(r.name).then(e=>{if(e){if("number"!=typeof e.version||e.version===r.version)return[!1,e.state];if(r.migrate){let t=r.migrate(e.state,e.version);return t instanceof Promise?t.then(e=>[!0,e]):[!0,t]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}return[!1,void 0]}).then(l=>{var o;if(n!==i)return;let[s,c]=l;if(e(a=r.merge(c,null!=(o=t())?o:g),!0),s)return b()}).then(()=>{n===i&&(null==p||p(a,void 0),a=t(),s=!0,d.forEach(e=>e(a)))}).catch(e=>{n===i&&(null==p||p(void 0,e))})};return l.persist={setOptions:e=>{r={...r,...e},e.storage&&(u=e.storage)},clearStorage:()=>{null==u||u.removeItem(r.name)},getOptions:()=>r,rehydrate:()=>f(),hasHydrated:()=>s,onHydrate:e=>(c.add(e),()=>{c.delete(e)}),onFinishHydration:e=>(d.add(e),()=>{d.delete(e)})},r.skipHydration||f(),a||g})),h=[{id:"tasks",label:"Tasks",icon:"✓"},{id:"braindump",label:"Dump",icon:"\uD83E\uDDE0"},{id:"planner",label:"Planner",icon:"\uD83D\uDCC5"},{id:"goals",label:"Goals",icon:"\uD83C\uDFAF"},{id:"knowledge",label:"Knowledge",icon:"\uD83D\uDCDA"}];function y(){let{activeMode:e,setActiveMode:t,exportData:l,importData:a,data:o,toggleDarkMode:n,toggleSidebar:i}=m(),c=(0,s.useRef)(null),d=o.settings.darkMode,u="flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-sm font-medium transition-all duration-150";return(0,r.jsxs)("header",{className:"flex items-center justify-between px-4 h-14 shrink-0 z-30",style:{background:d?"rgba(10,12,20,0.98)":"rgba(255,255,255,0.98)",borderBottom:"1px solid ".concat(d?"rgba(99,102,241,0.15)":"rgba(99,102,241,0.1)"),backdropFilter:"blur(16px)"},children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("button",{onClick:i,className:"w-8 h-8 rounded-lg flex items-center justify-center transition-colors",style:{color:d?"#6b7280":"#9ca3af",background:"transparent"},onMouseEnter:e=>e.target.style.background=d?"rgba(75,85,99,0.2)":"rgba(243,244,246,0.8)",onMouseLeave:e=>e.target.style.background="transparent",children:"☰"}),(0,r.jsxs)("div",{className:"flex items-center gap-2.5",children:[(0,r.jsx)("div",{className:"w-8 h-8 rounded-xl flex items-center justify-center text-white text-sm font-black shadow-lg",style:{background:"linear-gradient(135deg, #6366f1 0%, #8b5cf6 50%, #ec4899 100%)"},children:"M"}),(0,r.jsx)("span",{className:"font-black text-xl tracking-tight",style:{background:"linear-gradient(135deg, #6366f1, #8b5cf6)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},children:"MindFlow"})]})]}),(0,r.jsx)("nav",{className:"flex items-center gap-1 p-1 rounded-xl",style:{background:d?"rgba(22,25,38,0.9)":"rgba(243,244,246,0.9)"},children:h.map((l,a)=>{let o=e===l.id;return(0,r.jsxs)("button",{onClick:()=>t(l.id),className:"flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-sm font-semibold transition-all duration-200",style:{background:o?"linear-gradient(135deg, #6366f1, #8b5cf6)":"transparent",color:o?"#fff":d?"#9ca3af":"#6b7280",boxShadow:o?"0 2px 12px rgba(99,102,241,0.4)":"none",transform:o?"translateY(-1px)":"none"},title:"".concat(l.label," (").concat(a+1,")"),children:[(0,r.jsx)("span",{children:l.icon}),(0,r.jsx)("span",{className:"hidden md:inline",children:l.label})]},l.id)})}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsxs)("button",{onClick:l,className:u,style:{color:d?"#9ca3af":"#6b7280"},title:"Export JSON",children:[(0,r.jsx)("span",{className:"text-base",children:"↑"}),(0,r.jsx)("span",{className:"hidden sm:inline",children:"Export"})]}),(0,r.jsxs)("button",{onClick:()=>{var e;return null===(e=c.current)||void 0===e?void 0:e.click()},className:u,style:{color:d?"#9ca3af":"#6b7280"},title:"Import JSON",children:[(0,r.jsx)("span",{className:"text-base",children:"↓"}),(0,r.jsx)("span",{className:"hidden sm:inline",children:"Import"})]}),(0,r.jsx)("input",{ref:c,type:"file",accept:".json",className:"hidden",onChange:e=>{var t;let l=null===(t=e.target.files)||void 0===t?void 0:t[0];if(!l)return;let o=new FileReader;o.onload=e=>{try{var t;let l=JSON.parse(null===(t=e.target)||void 0===t?void 0:t.result);a(l)}catch(e){alert("Invalid JSON file. Please use a MindFlow export.")}},o.readAsText(l),e.target.value=""}}),(0,r.jsx)("div",{className:"w-px h-6 mx-1",style:{background:d?"rgba(75,85,99,0.4)":"rgba(229,231,235,0.8)"}}),(0,r.jsx)("button",{onClick:n,className:"w-9 h-9 rounded-xl flex items-center justify-center transition-all hover:scale-105",style:{background:d?"rgba(251,191,36,0.1)":"rgba(99,102,241,0.1)",color:d?"#fbbf24":"#6366f1"},title:"Toggle dark/light mode",children:d?"☀️":"\uD83C\uDF19"})]})]})}function v(e){return!!e&&new Date(e)<new Date}function k(e){let t=new Date(e),l=new Date,a=Math.ceil((t.getTime()-l.getTime())/864e5);return a<0?"".concat(Math.abs(a),"d overdue"):0===a?"Due today":1===a?"Due tomorrow":"Due in ".concat(a,"d")}function j(e,t){return 0===t?0:Math.min(100,Math.round(e/t*100))}let N={tasks:{icon:"✓",label:"Tasks"},braindump:{icon:"\uD83E\uDDE0",label:"Brain Dump"},planner:{icon:"\uD83D\uDCC5",label:"Planner"},goals:{icon:"\uD83C\uDFAF",label:"Goals"},knowledge:{icon:"\uD83D\uDCDA",label:"Knowledge"}};function w(){let{activeMode:e,setActiveMode:t,sidebarOpen:l,searchQuery:a,setSearchQuery:o,addNode:n,data:i,setSelectedNode:c,filterState:d,setFilter:u}=m(),[x,b]=(0,s.useState)(""),p=i.settings.darkMode,g=(0,s.useCallback)(()=>{if(!x.trim())return;let e=n(null,{label:x.trim()});b(""),c(e)},[x,n,c]),f=i.tasks.nodes.filter(e=>!e.isRoot),h={total:f.filter(e=>e.status).length,done:f.filter(e=>"done"===e.status).length,overdue:f.filter(e=>v(e.deadline)&&"done"!==e.status).length,urgent:f.filter(e=>"urgent"===e.priority&&"done"!==e.status).length},y=i.recentNodeIds.slice(0,8).map(e=>{for(let t of["tasks","braindump","planner","goals","knowledge"]){let l=i[t].nodes.find(t=>t.id===e);if(l)return{node:l,mode:t}}return null}).filter(Boolean);if(!l)return null;let k=e=>(0,r.jsx)("div",{className:"text-[10px] font-bold uppercase tracking-widest mb-2",style:{color:p?"#4b5563":"#9ca3af"},children:e}),j=(0,r.jsx)("div",{className:"my-2 h-px",style:{background:p?"rgba(75,85,99,0.15)":"rgba(229,231,235,0.5)"}});return(0,r.jsxs)("aside",{className:"flex flex-col h-full shrink-0 border-r overflow-hidden",style:{width:248,background:p?"rgba(9,11,18,0.98)":"rgba(248,250,252,0.98)",borderColor:p?"rgba(99,102,241,0.12)":"rgba(99,102,241,0.08)"},children:[(0,r.jsx)("div",{className:"px-3 pt-3 pb-2",children:(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("span",{className:"absolute left-2.5 top-1/2 -translate-y-1/2 text-gray-500 text-sm",children:"\uD83D\uDD0D"}),(0,r.jsx)("input",{type:"text",placeholder:"Search… (Ctrl+F)",value:a,onChange:e=>o(e.target.value),className:"w-full pl-8 pr-3 py-2 rounded-xl text-sm outline-none",style:{background:p?"rgba(22,25,38,0.9)":"rgba(255,255,255,0.9)",border:"1px solid ".concat(p?"rgba(75,85,99,0.3)":"rgba(209,213,219,0.5)"),color:p?"#e5e7eb":"#111827"}})]})}),j,(0,r.jsxs)("div",{className:"px-3 pb-2",children:[k("Quick Add"),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("input",{type:"text",placeholder:"New ".concat(e," node…"),value:x,onChange:e=>b(e.target.value),onKeyDown:e=>"Enter"===e.key&&g(),className:"flex-1 min-w-0 px-2.5 py-1.5 rounded-xl text-sm outline-none",style:{background:p?"rgba(22,25,38,0.9)":"rgba(255,255,255,0.9)",border:"1px solid ".concat(p?"rgba(75,85,99,0.3)":"rgba(209,213,219,0.5)"),color:p?"#e5e7eb":"#111827"}}),(0,r.jsx)("button",{onClick:g,className:"w-8 h-8 rounded-xl flex items-center justify-center text-white text-lg font-bold flex-shrink-0 transition-transform hover:scale-105 active:scale-95",style:{background:"linear-gradient(135deg, #6366f1, #8b5cf6)",boxShadow:"0 2px 8px rgba(99,102,241,0.4)"},children:"+"})]})]}),j,(0,r.jsxs)("div",{className:"px-3 pb-2",children:[k("Modes"),(0,r.jsx)("div",{className:"flex flex-col gap-0.5",children:Object.entries(N).map((l,a)=>{let[o,n]=l,s=e===o;return(0,r.jsxs)("button",{onClick:()=>t(o),className:"flex items-center gap-2.5 px-2.5 py-2 rounded-xl text-sm text-left transition-all",style:{background:s?"linear-gradient(135deg, rgba(99,102,241,0.2), rgba(139,92,246,0.15))":"transparent",border:s?"1px solid rgba(99,102,241,0.25)":"1px solid transparent",color:s?"#818cf8":p?"#6b7280":"#9ca3af",fontWeight:s?600:400},children:[(0,r.jsx)("span",{children:n.icon}),(0,r.jsx)("span",{className:"flex-1",children:n.label}),(0,r.jsx)("span",{className:"text-[10px] opacity-40 font-mono",children:a+1})]},o)})})]}),j,"tasks"===e&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"px-3 pb-2",children:[k("Filters"),(0,r.jsx)("div",{className:"grid grid-cols-2 gap-2 mb-3",children:[{label:"Total",value:h.total,color:"#6366f1"},{label:"Done",value:h.done,color:"#10b981"},{label:"Overdue",value:h.overdue,color:"#ef4444"},{label:"Urgent",value:h.urgent,color:"#f97316"}].map(e=>(0,r.jsxs)("div",{className:"rounded-xl p-2 text-center",style:{background:"".concat(e.color,"15")},children:[(0,r.jsx)("div",{className:"text-lg font-black",style:{color:e.color},children:e.value}),(0,r.jsx)("div",{className:"text-[10px] font-medium",style:{color:p?"#6b7280":"#9ca3af"},children:e.label})]},e.label))}),[{key:"showOverdue",label:"Only Overdue",color:"#ef4444"},{key:"showUrgent",label:"Only Urgent",color:"#f97316"}].map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between mb-1.5",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"w-2 h-2 rounded-full",style:{background:e.color}}),(0,r.jsx)("span",{className:"text-xs",style:{color:p?"#9ca3af":"#6b7280"},children:e.label})]}),(0,r.jsx)("button",{onClick:()=>u({[e.key]:!d[e.key]}),className:"relative w-10 h-5 rounded-full transition-colors",style:{background:d[e.key]?e.color:p?"#374151":"#d1d5db"},children:(0,r.jsx)("span",{className:"absolute top-0.5 w-4 h-4 bg-white rounded-full shadow transition-all",style:{left:d[e.key]?"1.25rem":"0.125rem"}})})]},e.key))]}),j]}),(0,r.jsxs)("div",{className:"flex-1 overflow-y-auto px-3 pb-2 min-h-0",children:[k("Recent"),0===y.length?(0,r.jsx)("p",{className:"text-xs italic",style:{color:p?"#4b5563":"#9ca3af"},children:"No recent nodes yet"}):(0,r.jsx)("div",{className:"flex flex-col gap-0.5",children:y.map(e=>{let{node:l,mode:a}=e;return(0,r.jsxs)("button",{onClick:()=>{t(a),c(l.id)},className:"flex items-center gap-2.5 px-2 py-1.5 rounded-lg text-left transition-colors w-full",style:{color:p?"#9ca3af":"#6b7280"},onMouseEnter:e=>e.currentTarget.style.background=p?"rgba(75,85,99,0.15)":"rgba(243,244,246,0.8)",onMouseLeave:e=>e.currentTarget.style.background="transparent",children:[(0,r.jsx)("div",{className:"w-2.5 h-2.5 rounded-full flex-shrink-0",style:{background:l.color}}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsx)("div",{className:"text-xs truncate",style:{color:p?"#d1d5db":"#374151"},children:l.label}),(0,r.jsx)("div",{className:"text-[10px] capitalize",style:{color:p?"#4b5563":"#9ca3af"},children:a})]})]},l.id)})})]}),(0,r.jsxs)("div",{className:"px-3 py-2 text-center border-t",style:{borderColor:p?"rgba(75,85,99,0.15)":"rgba(229,231,235,0.5)"},children:[(0,r.jsx)("div",{className:"text-[10px] font-mono",style:{color:p?"#374151":"#d1d5db"},children:"Tab=child \xb7 Enter=sibling \xb7 Del=remove"}),(0,r.jsx)("div",{className:"text-[10px] font-mono mt-0.5",style:{color:p?"#374151":"#d1d5db"},children:"1-5=mode \xb7 Ctrl+F=search \xb7 dbl-click=edit"})]})]})}function D(e){let{node:t,isSelected:l,isHighlighted:a,transform:o}=e,{setSelectedNode:n,editingNodeId:i,setEditingNode:c,updateNode:d,addNode:u,setContextMenu:x,activeMode:b,getChildren:p,data:g}=m(),[f,h]=(0,s.useState)(t.label),y=(0,s.useRef)(null),N=i===t.id,w=g.settings.darkMode,D=p(t.id).length>0,C=v(t.deadline)&&"done"!==t.status,S=t.targetValue?j(t.currentValue||0,t.targetValue):null;(0,s.useEffect)(()=>{h(t.label)},[t.label]),(0,s.useEffect)(()=>{N&&y.current&&(y.current.focus(),y.current.select())},[N]);let I=(0,s.useCallback)(e=>{if(N)return;e.stopPropagation(),n(t.id);let l=e.clientX,a=e.clientY,r=t.position.x,s=t.position.y,i=e=>{let n=(e.clientX-l)/o.scale,i=(e.clientY-a)/o.scale;(Math.abs(n)>3||Math.abs(i)>3)&&d(t.id,{position:{x:r+n,y:s+i}})},c=()=>{document.removeEventListener("mousemove",i),document.removeEventListener("mouseup",c)};document.addEventListener("mousemove",i),document.addEventListener("mouseup",c)},[N,t.id,t.position,o.scale,n,d]),M=(0,s.useCallback)(e=>{e.stopPropagation(),c(t.id),h(t.label)},[t.id,t.label,c]),E=(0,s.useCallback)(()=>{f.trim()&&d(t.id,{label:f.trim()}),c(null)},[f,t.id,d,c]),T=(0,s.useCallback)(e=>{"Enter"===e.key&&E(),"Escape"===e.key&&(h(t.label),c(null))},[E,t.label,c]),R=(0,s.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),x({visible:!0,x:e.clientX,y:e.clientY,nodeId:t.id})},[t.id,x]),O=l?t.color:a?"#f59e0b":C?"#ef4444":"done"===t.status?"#10b981":"".concat(t.color,"55"),F="goals"===b&&null!==S?1+S/100*.3:1;return(0,r.jsxs)("div",{className:"absolute flex flex-col items-center justify-center rounded-2xl cursor-pointer group transition-all duration-200",style:{left:t.position.x,top:t.position.y,transform:"translate(-50%, -50%) scale(".concat(F,")"),transformOrigin:"center",background:t.isRoot?"linear-gradient(135deg, ".concat(t.color,"33, ").concat(t.color,"18)"):w?"rgba(22, 25, 38, 0.96)":"rgba(255,255,255,0.96)",border:"2px solid ".concat(O),boxShadow:l?"0 0 0 3px ".concat(t.color,"44, 0 12px 40px ").concat(t.color,"22, 0 4px 16px rgba(0,0,0,0.4)"):"0 4px 20px rgba(0,0,0,0.15), inset 0 1px 0 rgba(255,255,255,0.04)",backdropFilter:"blur(12px)",padding:"10px 16px",minWidth:t.isRoot?160:130,zIndex:l?20:10,willChange:"transform"},onMouseDown:I,onDoubleClick:M,onContextMenu:R,children:[t.status&&(0,r.jsx)("div",{className:"absolute -top-1.5 -right-1.5 w-4 h-4 rounded-full border-2 flex items-center justify-center",style:{background:"done"===t.status?"#10b981":"doing"===t.status?"#f59e0b":"#6b7280",borderColor:w?"#0d0f17":"#fff"},children:"done"===t.status&&(0,r.jsx)("span",{className:"text-[7px] text-white font-bold",children:"✓"})}),"urgent"===t.priority&&"done"!==t.status&&(0,r.jsx)("div",{className:"absolute -top-1.5 -left-1.5 w-4 h-4 rounded-full border-2 flex items-center justify-center",style:{background:"#ef4444",borderColor:w?"#0d0f17":"#fff"},children:(0,r.jsx)("span",{className:"text-[7px] text-white font-bold",children:"!"})}),!0===t.completed&&(0,r.jsx)("div",{className:"absolute -top-1.5 -right-1.5 w-5 h-5 rounded-full border-2 flex items-center justify-center",style:{background:"#10b981",borderColor:w?"#0d0f17":"#fff"},children:(0,r.jsx)("span",{className:"text-[9px] text-white",children:"✓"})}),N?(0,r.jsx)("input",{ref:y,value:f,onChange:e=>h(e.target.value),onBlur:E,onKeyDown:T,className:"bg-transparent border-none outline-none text-center font-medium w-full text-sm",style:{color:t.isRoot?t.color:w?"#f3f4f6":"#111827",minWidth:80},onClick:e=>e.stopPropagation()}):(0,r.jsx)("div",{className:"text-center font-medium leading-tight",style:{color:t.isRoot?t.color:w?"#f3f4f6":"#111827",fontSize:t.isRoot?"0.95rem":"0.82rem",fontWeight:t.isRoot?700:500,textDecoration:"done"===t.status?"line-through":"none",opacity:"done"===t.status?.6:1},children:t.label}),"goals"===b&&t.targetValue&&null!==S&&(0,r.jsxs)("div",{className:"w-full mt-2",children:[(0,r.jsxs)("div",{className:"flex justify-between mb-1",style:{color:t.color,fontSize:9},children:[(0,r.jsx)("span",{children:(t.currentValue||0).toLocaleString()}),(0,r.jsx)("span",{children:t.targetValue.toLocaleString()})]}),(0,r.jsx)("div",{className:"w-full h-1.5 rounded-full overflow-hidden",style:{background:w?"rgba(75,85,99,0.4)":"rgba(229,231,235,0.6)"},children:(0,r.jsx)("div",{className:"h-full rounded-full",style:{width:"".concat(S,"%"),background:"linear-gradient(90deg, ".concat(t.color,", ").concat(t.color,"cc)"),boxShadow:"0 0 6px ".concat(t.color,"99"),transition:"width 0.6s ease"}})}),(0,r.jsxs)("div",{className:"text-center mt-0.5",style:{fontSize:9,color:t.color},children:[S,"%"]})]}),t.deadline&&"done"!==t.status&&(0,r.jsx)("div",{className:"text-center mt-1 font-medium",style:{fontSize:10,color:C?"#f87171":"#9ca3af"},children:k(t.deadline)}),"planner"===b&&t.estimatedTime&&(0,r.jsxs)("div",{className:"text-center mt-0.5",style:{fontSize:10,color:"#9ca3af"},children:[t.estimatedTime,"min"]}),"knowledge"===b&&t.tags&&t.tags.length>0&&(0,r.jsx)("div",{className:"flex flex-wrap gap-1 justify-center mt-1.5",children:t.tags.slice(0,3).map(e=>(0,r.jsxs)("span",{className:"px-1.5 py-0.5 rounded-full",style:{fontSize:9,background:"".concat(t.color,"22"),color:t.color},children:["#",e]},e))}),"knowledge"===b&&t.notes&&(0,r.jsx)("div",{className:"mt-1",style:{fontSize:9,color:"#6b7280"},children:"\uD83D\uDCDD Has notes"}),D&&(0,r.jsx)("button",{className:"absolute -bottom-3.5 left-1/2 -translate-x-1/2 w-6 h-6 rounded-full flex items-center justify-center text-white transition-all hover:scale-110 z-30 text-xs font-bold border-2",style:{background:t.color,borderColor:w?"#0d0f17":"#fff",boxShadow:"0 2px 8px ".concat(t.color,"66")},onClick:e=>{e.stopPropagation(),d(t.id,{collapsed:!t.collapsed})},children:t.collapsed?"+":"−"}),l&&(0,r.jsx)("button",{className:"absolute -right-5 top-1/2 -translate-y-1/2 w-8 h-8 rounded-full border-2 border-dashed flex items-center justify-center transition-all hover:scale-110 z-30 text-sm opacity-80 hover:opacity-100",style:{borderColor:t.color,color:t.color,background:w?"#0d0f17":"#fff"},onClick:e=>{e.stopPropagation(),u(t.id)},title:"Add child (Tab)",children:"+"})]})}function C(e){let{x:t,y:l,nodeId:a,onClose:o}=e,{addNode:n,deleteNode:i,updateNode:c,getNodeById:d,setEditingNode:u,activeMode:x,data:p}=m(),g=(0,s.useRef)(null),[f,h]=(0,s.useState)(null),[y,v]=(0,s.useState)(""),k=p.settings.darkMode,j=a?d(a):null;(0,s.useEffect)(()=>{let e=e=>{g.current&&!g.current.contains(e.target)&&o()};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[o]);let N=Math.min(t,window.innerWidth-220),w=Math.min(l,window.innerHeight-380),D=k?"rgba(75,85,99,0.4)":"rgba(229,231,235,0.8)",C=k?"#d1d5db":"#374151",S=k?"rgba(55,65,81,0.5)":"rgba(243,244,246,0.8)",I=a?[{icon:"✏️",label:"Rename",action:()=>{u(a),o()}},{icon:"➕",label:"Add Child",action:()=>{n(a),o()}},{icon:"\uD83C\uDFA8",label:"Change Color…",action:()=>h("color")},..."tasks"===x?[{icon:"\uD83D\uDCC5",label:"Set Deadline…",action:()=>h("deadline")},{type:"sep"},{icon:"✅",label:"Mark Done",action:()=>{c(a,{status:"done"}),o()}},{icon:"\uD83D\uDD04",label:"Mark In Progress",action:()=>{c(a,{status:"doing"}),o()}},{icon:"⭕",label:"Mark Todo",action:()=>{c(a,{status:"todo"}),o()}},{icon:"\uD83D\uDD34",label:"Set Urgent",action:()=>{c(a,{priority:"urgent"}),o()}}]:[],..."planner"===x?[{icon:"✅",label:"Mark Complete",action:()=>{c(a,{completed:!0}),o()}},{icon:"⭕",label:"Mark Incomplete",action:()=>{c(a,{completed:!1}),o()}}]:[],{type:"sep"},{icon:"\uD83D\uDDD1️",label:"Delete",danger:!0,action:()=>{i(a),o()}}]:[{icon:"➕",label:"Add Root Node",action:()=>{n(null),o()}}];return(0,r.jsxs)("div",{ref:g,className:"fixed z-50 rounded-xl shadow-2xl overflow-hidden animate-fade-in",style:{left:N,top:w,background:k?"rgba(15,17,26,0.98)":"rgba(255,255,255,0.98)",border:"1px solid ".concat(D),minWidth:190,backdropFilter:"blur(16px)"},children:[j&&(0,r.jsxs)("div",{className:"px-3 py-2.5 border-b flex items-center gap-2",style:{borderColor:D,background:"".concat(j.color,"11")},children:[(0,r.jsx)("div",{className:"w-2.5 h-2.5 rounded-full flex-shrink-0",style:{background:j.color}}),(0,r.jsx)("span",{className:"text-xs font-semibold truncate",style:{color:j.color},children:j.label})]}),"color"===f&&(0,r.jsxs)("div",{className:"p-3",children:[(0,r.jsx)("div",{className:"text-xs text-gray-400 mb-2",children:"Choose color"}),(0,r.jsx)("div",{className:"grid grid-cols-5 gap-2",children:b.map(e=>(0,r.jsx)("button",{className:"w-8 h-8 rounded-full transition-transform hover:scale-110 active:scale-95",style:{background:e,outline:(null==j?void 0:j.color)===e?"2px solid ".concat(e):"none",outlineOffset:2},onClick:()=>{a&&(c(a,{color:e}),o())}},e))})]}),"deadline"===f&&(0,r.jsxs)("div",{className:"p-3",children:[(0,r.jsx)("div",{className:"text-xs text-gray-400 mb-2",children:"Set deadline"}),(0,r.jsx)("input",{type:"date",value:y,onChange:e=>v(e.target.value),autoFocus:!0,className:"w-full rounded-lg px-2 py-1.5 text-sm outline-none",style:{background:k?"rgba(30,32,44,0.9)":"rgba(249,250,251,0.9)",border:"1px solid ".concat(k?"rgba(75,85,99,0.5)":"rgba(209,213,219,0.6)"),color:k?"#f3f4f6":"#111827"},onKeyDown:e=>{"Enter"===e.key&&y&&a&&(c(a,{deadline:new Date(y+"T23:59:59").toISOString()}),o())}}),(0,r.jsx)("button",{className:"w-full mt-2 py-1.5 rounded-lg text-sm font-semibold text-white",style:{background:"linear-gradient(135deg, #6366f1, #8b5cf6)"},onClick:()=>{y&&a&&(c(a,{deadline:new Date(y+"T23:59:59").toISOString()}),o())},children:"Set Deadline"})]}),!f&&(0,r.jsx)("div",{className:"py-1",children:I.map((e,t)=>"type"in e&&"sep"===e.type?(0,r.jsx)("div",{className:"my-1 h-px mx-2",style:{background:D}},t):(0,r.jsxs)("button",{onClick:"action"in e?e.action:void 0,className:"w-full flex items-center gap-2.5 px-3 py-2 text-sm text-left transition-colors",style:{color:"danger"in e&&e.danger?"#f87171":C},onMouseEnter:t=>{t.currentTarget.style.background="danger"in e&&e.danger?"rgba(239,68,68,0.1)":S},onMouseLeave:e=>{e.currentTarget.style.background="transparent"},children:[(0,r.jsx)("span",{children:e.icon}),(0,r.jsx)("span",{children:e.label})]},t))})]})}function S(){let{getNodes:e,activeMode:t,selectedNodeId:l,setSelectedNode:a,contextMenu:o,setContextMenu:n,searchQuery:i,data:c,filterState:d,addNode:u}=m(),x=(0,s.useRef)(null),[b,p]=(0,s.useState)({x:0,y:0,scale:1}),g=(0,s.useRef)(!1),f=(0,s.useRef)({x:0,y:0}),h=(0,s.useRef)(0),y=e();(0,s.useEffect)(()=>{p({x:window.innerWidth/2,y:window.innerHeight/2,scale:1})},[t]);let k=(0,s.useCallback)(e=>{let t=e.target;(t===x.current||t.dataset.canvas)&&(g.current=!0,f.current={x:e.clientX,y:e.clientY},a(null),n({visible:!1,x:0,y:0,nodeId:null}))},[a,n]),j=(0,s.useCallback)(e=>{if(!g.current)return;let t=e.clientX-f.current.x,l=e.clientY-f.current.y;f.current={x:e.clientX,y:e.clientY},p(e=>({...e,x:e.x+t,y:e.y+l}))},[]),N=(0,s.useCallback)(()=>{g.current=!1},[]),w=(0,s.useCallback)(e=>{e.preventDefault();let t=e.deltaY>0?.9:1.1,l=x.current.getBoundingClientRect(),a=e.clientX-l.left,o=e.clientY-l.top;p(e=>{let l=Math.max(.15,Math.min(3,e.scale*t)),n=l/e.scale;return{x:a-(a-e.x)*n,y:o-(o-e.y)*n,scale:l}})},[]),S=(0,s.useCallback)(e=>{let t=e.target;(t===x.current||t.dataset.canvas)&&(e.preventDefault(),n({visible:!0,x:e.clientX,y:e.clientY,nodeId:null}))},[n]),I=(0,s.useCallback)(e=>{if(2===e.touches.length){let t=e.touches[0].clientX-e.touches[1].clientX,l=e.touches[0].clientY-e.touches[1].clientY;h.current=Math.hypot(t,l)}else g.current=!0,f.current={x:e.touches[0].clientX,y:e.touches[0].clientY}},[]),M=(0,s.useCallback)(e=>{if(2===e.touches.length){let t=Math.hypot(e.touches[0].clientX-e.touches[1].clientX,e.touches[0].clientY-e.touches[1].clientY),l=t/h.current;h.current=t;let a=(e.touches[0].clientX+e.touches[1].clientX)/2,o=(e.touches[0].clientY+e.touches[1].clientY)/2;p(e=>{let t=Math.max(.15,Math.min(3,e.scale*l)),n=t/e.scale;return{x:a-(a-e.x)*n,y:o-(o-e.y)*n,scale:t}})}else if(g.current){let t=e.touches[0].clientX-f.current.x,l=e.touches[0].clientY-f.current.y;f.current={x:e.touches[0].clientX,y:e.touches[0].clientY},p(e=>({...e,x:e.x+t,y:e.y+l}))}},[]),E=(0,s.useCallback)(()=>{g.current=!1},[]),T=s.useMemo(()=>{if("tasks"!==t)return y;let{showOverdue:e,showUrgent:l,projectId:a}=d;return e||l||a?y.filter(t=>!!t.isRoot||!t.parentId||(!e||!!v(t.deadline))&&(!l||"urgent"===t.priority)):y},[y,t,d]),R=c.settings.darkMode;return(0,r.jsxs)("div",{ref:x,className:"relative w-full h-full overflow-hidden",style:{cursor:g.current?"grabbing":"grab",userSelect:"none"},onMouseDown:k,onMouseMove:j,onMouseUp:N,onMouseLeave:N,onWheel:w,onContextMenu:S,onTouchStart:I,onTouchMove:M,onTouchEnd:E,"data-canvas":"true",children:[(0,r.jsx)("div",{className:"absolute inset-0 pointer-events-none","data-canvas":"true",style:{backgroundImage:"radial-gradient(circle, ".concat(R?"#2d3148":"#c7d2fe"," 1.5px, transparent 1.5px)"),backgroundSize:"".concat(32*b.scale,"px ").concat(32*b.scale,"px"),backgroundPosition:"".concat(b.x%(32*b.scale),"px ").concat(b.y%(32*b.scale),"px"),opacity:.4}}),(0,r.jsxs)("div",{style:{transform:"translate(".concat(b.x,"px, ").concat(b.y,"px) scale(").concat(b.scale,")"),transformOrigin:"0 0",position:"absolute",inset:0,width:1,height:1},children:[(0,r.jsx)("svg",{style:{position:"absolute",left:-8e3,top:-8e3,width:16e3,height:16e3,overflow:"visible",pointerEvents:"none"},children:(()=>{let e=[],t=new Map(y.map(e=>[e.id,e]));for(let a of T){if(!a.parentId)continue;let o=t.get(a.parentId);if(!o||o.collapsed)continue;let n=o.position.x,s=o.position.y,c=a.position.x,d=a.position.y,u=(n+c)/2,x="M ".concat(n," ").concat(s," C ").concat(u," ").concat(s,", ").concat(u," ").concat(d,", ").concat(c," ").concat(d),b=!!i&&a.label.toLowerCase().includes(i.toLowerCase()),p=v(a.deadline)&&"done"!==a.status,g=b?"#f59e0b":p?"#ef4444":a.color,f=l===a.id;e.push((0,r.jsx)("path",{d:x,stroke:g,strokeWidth:f?3:2,strokeOpacity:f?.9:.5,fill:"none",strokeLinecap:"round",style:{filter:f?"drop-shadow(0 0 4px ".concat(g,")"):"none",transition:"all 0.2s ease"}},"e-".concat(a.id)))}return e})()}),T.filter(e=>{if(!e.parentId)return!0;let t=e=>{let l=y.find(t=>t.id===e);return!!l&&(!!l.collapsed||!!l.parentId&&t(l.parentId))};return!t(e.parentId)}).map(e=>(0,r.jsx)(D,{node:e,isSelected:l===e.id,isHighlighted:!!i&&e.label.toLowerCase().includes(i.toLowerCase()),transform:b},e.id))]}),(0,r.jsx)("div",{className:"absolute bottom-6 right-6 flex flex-col gap-2 z-20",children:[{label:"+",action:()=>p(e=>({...e,scale:Math.min(3,1.25*e.scale)}))},{label:"−",action:()=>p(e=>({...e,scale:Math.max(.15,.8*e.scale)}))},{label:"⌂",action:()=>p({x:window.innerWidth/2,y:window.innerHeight/2,scale:1})}].map(e=>{let{label:t,action:l}=e;return(0,r.jsx)("button",{onClick:l,className:"w-10 h-10 rounded-xl flex items-center justify-center font-bold text-base transition-all hover:scale-105 active:scale-95 shadow-lg",style:{background:R?"rgba(22,25,38,0.9)":"rgba(255,255,255,0.9)",border:"1px solid ".concat(R?"rgba(99,102,241,0.3)":"rgba(99,102,241,0.2)"),color:R?"#818cf8":"#6366f1",backdropFilter:"blur(8px)"},children:t},t)})}),(0,r.jsxs)("div",{className:"absolute bottom-6 left-1/2 -translate-x-1/2 px-3 py-1 rounded-full text-xs z-10",style:{background:R?"rgba(22,25,38,0.8)":"rgba(255,255,255,0.8)",border:"1px solid ".concat(R?"rgba(75,85,99,0.3)":"rgba(229,231,235,0.5)"),color:R?"#6b7280":"#9ca3af",backdropFilter:"blur(8px)"},children:[Math.round(100*b.scale),"%"]}),o.visible&&(0,r.jsx)(C,{x:o.x,y:o.y,nodeId:o.nodeId,onClose:()=>n({visible:!1,x:0,y:0,nodeId:null})})]})}let I=[{v:"todo",label:"Todo",color:"#6b7280"},{v:"doing",label:"Doing",color:"#f59e0b"},{v:"done",label:"Done",color:"#10b981"}],M=[{v:"urgent",label:"\uD83D\uDD34 Urgent",color:"#ef4444"},{v:"high",label:"\uD83D\uDFE0 High",color:"#f97316"},{v:"normal",label:"\uD83D\uDD35 Normal",color:"#6366f1"},{v:"low",label:"⚪ Low",color:"#6b7280"}];function E(){let{selectedNodeId:e,data:t,updateNode:l,deleteNode:a,addNode:o,getNodeById:n,setSelectedNode:i,activeMode:c}=m(),d=t.settings.darkMode,u=e?n(e):null,[x,p]=(0,s.useState)(""),[g,f]=(0,s.useState)("");if((0,s.useEffect)(()=>{u&&(p(u.label),f(u.deadline?u.deadline.split("T")[0]:""))},[null==u?void 0:u.id]),!u)return null;let h=v(u.deadline)&&"done"!==u.status;return(0,r.jsx)("div",{className:"absolute right-4 top-4 z-20 w-72",style:{pointerEvents:"all"},children:(0,r.jsxs)("div",{className:"rounded-2xl overflow-hidden shadow-2xl",style:{background:d?"rgba(13,15,24,0.97)":"rgba(255,255,255,0.97)",border:"2px solid ".concat(u.color,"44"),backdropFilter:"blur(16px)"},children:[(0,r.jsxs)("div",{className:"px-4 py-3 flex items-center justify-between",style:{background:"".concat(u.color,"15"),borderBottom:"1px solid ".concat(u.color,"22")},children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"w-3 h-3 rounded-full",style:{background:u.color,boxShadow:"0 0 8px ".concat(u.color)}}),(0,r.jsx)("span",{className:"text-xs font-bold uppercase tracking-widest",style:{color:u.color},children:u.isRoot?"Workspace":"tasks"===c?"Task":"Node"})]}),(0,r.jsx)("button",{onClick:()=>i(null),className:"w-6 h-6 rounded-full flex items-center justify-center text-gray-400 hover:text-gray-200 hover:bg-white/10 transition-colors",children:"✕"})]}),(0,r.jsxs)("div",{className:"p-4 space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-xs font-semibold text-gray-400 uppercase tracking-wider block mb-1.5",children:"Label"}),(0,r.jsx)("input",{value:x,onChange:e=>p(e.target.value),onBlur:()=>x.trim()&&l(u.id,{label:x.trim()}),onKeyDown:e=>"Enter"===e.key&&x.trim()&&l(u.id,{label:x.trim()}),className:"w-full px-3 py-2 rounded-xl text-sm font-medium outline-none",style:{background:d?"rgba(30,32,44,0.8)":"rgba(249,250,251,0.8)",border:"1px solid ".concat(u.color,"44"),color:d?"#f3f4f6":"#111827"}})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-xs font-semibold text-gray-400 uppercase tracking-wider block mb-2",children:"Color"}),(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:b.map(e=>(0,r.jsx)("button",{onClick:()=>l(u.id,{color:e}),className:"w-7 h-7 rounded-full transition-transform hover:scale-110 active:scale-95",style:{background:e,outline:u.color===e?"3px solid ".concat(e):"none",outlineOffset:2,boxShadow:u.color===e?"0 0 10px ".concat(e,"88"):"none"}},e))})]}),"tasks"===c&&!u.isRoot&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-xs font-semibold text-gray-400 uppercase tracking-wider block mb-1.5",children:"Status"}),(0,r.jsx)("div",{className:"flex gap-1.5",children:I.map(e=>(0,r.jsx)("button",{onClick:()=>l(u.id,{status:e.v}),className:"flex-1 py-1.5 rounded-lg text-xs font-semibold transition-all",style:{background:u.status===e.v?e.color:"".concat(e.color,"22"),color:u.status===e.v?"#fff":e.color,border:"1px solid ".concat(e.color,"44")},children:e.label},e.v))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-xs font-semibold text-gray-400 uppercase tracking-wider block mb-1.5",children:"Priority"}),(0,r.jsx)("div",{className:"grid grid-cols-2 gap-1.5",children:M.map(e=>(0,r.jsx)("button",{onClick:()=>l(u.id,{priority:e.v}),className:"py-1.5 rounded-lg text-xs font-semibold transition-all",style:{background:u.priority===e.v?e.color:"".concat(e.color,"22"),color:u.priority===e.v?"#fff":e.color,border:"1px solid ".concat(e.color,"44")},children:e.label},e.v))})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"text-xs font-semibold uppercase tracking-wider block mb-1.5",style:{color:h?"#f87171":"#6b7280"},children:["Deadline ",h&&"⚠ Overdue!"]}),(0,r.jsx)("input",{type:"date",value:g,onChange:e=>{f(e.target.value),e.target.value&&l(u.id,{deadline:new Date(e.target.value+"T23:59:59").toISOString()})},className:"w-full px-3 py-2 rounded-xl text-sm outline-none",style:{background:d?"rgba(30,32,44,0.8)":"rgba(249,250,251,0.8)",border:"1px solid ".concat(h?"#ef4444":u.color,"44"),color:d?"#f3f4f6":"#111827"}}),u.deadline&&(0,r.jsx)("p",{className:"text-xs mt-1",style:{color:h?"#f87171":"#6b7280"},children:k(u.deadline)})]})]}),"goals"===c&&!u.isRoot&&(0,r.jsx)("div",{className:"flex gap-2",children:[{label:"Current",key:"currentValue"},{label:"Target",key:"targetValue"}].map(e=>(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("label",{className:"text-xs font-semibold text-gray-400 uppercase tracking-wider block mb-1",children:e.label}),(0,r.jsx)("input",{type:"number",defaultValue:u[e.key]||0,onBlur:t=>l(u.id,{[e.key]:Number(t.target.value)}),className:"w-full px-2.5 py-2 rounded-xl text-sm outline-none",style:{background:d?"rgba(30,32,44,0.8)":"rgba(249,250,251,0.8)",border:"1px solid ".concat(u.color,"44"),color:d?"#f3f4f6":"#111827"}})]},e.key))}),"planner"===c&&!u.isRoot&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-xs font-semibold text-gray-400 uppercase tracking-wider block mb-1.5",children:"Estimated Time (min)"}),(0,r.jsx)("input",{type:"number",defaultValue:u.estimatedTime||0,onBlur:e=>l(u.id,{estimatedTime:Number(e.target.value)}),className:"w-full px-3 py-2 rounded-xl text-sm outline-none",style:{background:d?"rgba(30,32,44,0.8)":"rgba(249,250,251,0.8)",border:"1px solid ".concat(u.color,"44"),color:d?"#f3f4f6":"#111827"}})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("button",{onClick:()=>l(u.id,{completed:!0}),className:"flex-1 py-1.5 rounded-lg text-xs font-semibold text-white",style:{background:u.completed?"#10b981":"".concat(u.color,"33"),color:u.completed?"#fff":u.color},children:"✓ Complete"}),(0,r.jsx)("button",{onClick:()=>l(u.id,{completed:!1}),className:"flex-1 py-1.5 rounded-lg text-xs font-semibold",style:{background:u.completed?"transparent":"#6b728033",color:"#6b7280",border:"1px solid #6b728044"},children:"Reset"})]})]}),(0,r.jsxs)("div",{className:"flex gap-2 pt-2 border-t",style:{borderColor:d?"rgba(75,85,99,0.2)":"rgba(229,231,235,0.5)"},children:[(0,r.jsx)("button",{onClick:()=>o(u.id),className:"flex-1 py-2 rounded-xl text-xs font-bold text-white transition-all hover:opacity-80",style:{background:"linear-gradient(135deg, ".concat(u.color,", ").concat(u.color,"bb)")},children:"+ Add Child"}),!u.isRoot&&(0,r.jsx)("button",{onClick:()=>{a(u.id),i(null)},className:"px-3 py-2 rounded-xl text-xs font-semibold transition-all hover:bg-red-500/10",style:{color:"#f87171",border:"1px solid rgba(239,68,68,0.3)"},children:"\uD83D\uDDD1️"})]})]})]})})}function T(){let{selectedNodeId:e,addNode:t,deleteNode:l,setActiveMode:a,getNodeById:o,setEditingNode:n}=m();return(0,s.useEffect)(()=>{let r=r=>{let s=r.target.tagName,i="INPUT"===s||"TEXTAREA"===s||r.target.isContentEditable;if((r.ctrlKey||r.metaKey)&&"f"===r.key){r.preventDefault();let e=document.querySelector('input[placeholder*="Search"]');null==e||e.focus();return}if(i)return;let c={1:"tasks",2:"braindump",3:"planner",4:"goals",5:"knowledge"};if(c[r.key]&&!r.ctrlKey&&!r.metaKey){a(c[r.key]);return}if(!e)return;let d=o(e);d&&("Tab"===r.key?(r.preventDefault(),t(e)):"Enter"===r.key?(r.preventDefault(),t(d.parentId)):"Delete"===r.key||"Backspace"===r.key&&r.metaKey?d.isRoot||l(e):("F2"===r.key||"e"===r.key)&&(r.preventDefault(),n(e)))};return window.addEventListener("keydown",r),()=>window.removeEventListener("keydown",r)},[e,t,l,a,o,n]),null}function R(){let{data:e,addNode:t,updateNode:l,getNodes:a}=m(),[o,n]=(0,s.useState)(""),[i,c]=(0,s.useState)(!1),d=e.settings.darkMode,u=a(),x=u.filter(e=>!e.parentId).length,b=(0,s.useCallback)(()=>{let e=o.split("\n").map(e=>e.trim()).filter(Boolean);e.length&&(c(!0),e.forEach((e,l)=>{setTimeout(()=>{t(null,{label:e,isDumped:!0,color:"#6b7280",position:{x:(Math.random()-.5)*700,y:(Math.random()-.5)*500}})},80*l)}),setTimeout(()=>{c(!1),n("")},80*e.length+300))},[o,t]),p=(0,s.useCallback)(()=>{let e=function(e){let t={work:["meeting","project","deadline","report","email","client","boss","team","sprint","review"],personal:["gym","fitness","health","family","friend","dinner","vacation","buy","shopping"],learning:["read","study","course","book","learn","research","tutorial","practice"],ideas:["idea","concept","maybe","could","should","what if","explore","try"]},l={work:"#3b82f6",personal:"#ec4899",learning:"#f59e0b",ideas:"#8b5cf6",other:"#6b7280"};return e.map(e=>{let a=e.label.toLowerCase(),o="other";for(let[e,l]of Object.entries(t))if(l.some(e=>a.includes(e))){o=e;break}return{...e,color:l[o]}})}(u.filter(e=>!e.parentId&&e.isDumped)),t={};e.forEach(e=>{(t[e.color]=t[e.color]||[]).push(e)}),Object.entries(t).forEach((e,a)=>{let[,o]=e,n=a/Object.keys(t).length*Math.PI*2,r=320*Math.cos(n),s=320*Math.sin(n);o.forEach((e,t)=>{let a=(t/(o.length||1)-.5)*160;l(e.id,{color:e.color,position:{x:r+a,y:s+80*Math.sin(t)}})})})},[u,l]);return(0,r.jsx)("div",{className:"absolute top-4 left-1/2 -translate-x-1/2 z-20 w-full max-w-xl px-4",style:{pointerEvents:"none"},children:(0,r.jsxs)("div",{className:"rounded-2xl overflow-hidden shadow-2xl",style:{background:d?"rgba(10,12,20,0.96)":"rgba(255,255,255,0.96)",border:"1px solid ".concat(d?"rgba(99,102,241,0.25)":"rgba(99,102,241,0.15)"),backdropFilter:"blur(16px)",boxShadow:"0 20px 60px rgba(0,0,0,0.3)",pointerEvents:"all"},children:[(0,r.jsxs)("div",{className:"px-4 py-3 flex items-center gap-3",style:{background:"linear-gradient(135deg, rgba(99,102,241,0.12), rgba(139,92,246,0.08))",borderBottom:"1px solid ".concat(d?"rgba(99,102,241,0.15)":"rgba(99,102,241,0.1)")},children:[(0,r.jsx)("div",{className:"w-8 h-8 rounded-xl flex items-center justify-center text-lg",style:{background:"rgba(99,102,241,0.15)"},children:"\uD83E\uDDE0"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"font-bold text-sm",style:{color:"#818cf8"},children:"Brain Dump"}),(0,r.jsx)("div",{className:"text-xs",style:{color:d?"#4b5563":"#9ca3af"},children:"Empty your mind. Organize later."})]}),x>0&&(0,r.jsxs)("div",{className:"ml-auto flex items-center gap-1.5 px-2.5 py-1 rounded-full",style:{background:"rgba(99,102,241,0.15)"},children:[(0,r.jsx)("div",{className:"w-1.5 h-1.5 rounded-full bg-violet-400 animate-pulse"}),(0,r.jsxs)("span",{className:"text-xs font-semibold",style:{color:"#818cf8"},children:[x," on canvas"]})]})]}),(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsx)("textarea",{placeholder:"Write whatever's on your mind...\n• One thought per line\n• Press Shift+Enter to dump\n• Don't filter, just write!",value:o,onChange:e=>n(e.target.value),onKeyDown:e=>{"Enter"===e.key&&e.shiftKey&&(e.preventDefault(),b())},rows:4,className:"w-full resize-none rounded-xl p-3 text-sm outline-none",style:{background:d?"rgba(22,25,38,0.9)":"rgba(249,250,251,0.9)",border:"1px solid ".concat(d?"rgba(99,102,241,0.2)":"rgba(99,102,241,0.15)"),color:d?"#e5e7eb":"#111827",lineHeight:1.7}}),(0,r.jsxs)("div",{className:"flex gap-2 mt-3",children:[(0,r.jsx)("button",{onClick:b,disabled:!o.trim()||i,className:"flex-1 py-2.5 rounded-xl text-sm font-bold text-white transition-all hover:opacity-90 active:scale-95 disabled:opacity-40",style:{background:"linear-gradient(135deg, #6366f1, #8b5cf6)",boxShadow:"0 4px 16px rgba(99,102,241,0.4)"},children:i?"✨ Dumping...":"→ Dump It (Shift+Enter)"}),(0,r.jsx)("button",{onClick:p,disabled:0===x,className:"px-4 py-2.5 rounded-xl text-sm font-bold transition-all hover:opacity-80 active:scale-95 disabled:opacity-30",style:{background:d?"rgba(22,25,38,0.9)":"rgba(243,244,246,0.9)",border:"1px solid ".concat(d?"rgba(99,102,241,0.3)":"rgba(99,102,241,0.2)"),color:"#818cf8"},children:"\uD83E\uDD16 Auto-Group"})]})]}),(0,r.jsxs)("div",{className:"px-4 pb-3 flex items-center gap-4 text-[11px]",style:{borderTop:"1px solid ".concat(d?"rgba(75,85,99,0.15)":"rgba(229,231,235,0.5)"),paddingTop:10,color:d?"#4b5563":"#9ca3af"},children:[(0,r.jsx)("span",{children:"\uD83D\uDCA1 Each line = 1 node"}),(0,r.jsx)("span",{children:"\uD83C\uDFAF Drag to organize"}),(0,r.jsx)("span",{children:"\uD83E\uDD16 Auto-groups by topic"})]})]})})}function O(){let{data:e,getNodes:t}=m(),l=e.settings.darkMode,a=t(),o=function(e){let t=e.filter(e=>!e.isRoot&&void 0!==e.completed);return 0===t.length?0:Math.round(t.filter(e=>!0===e.completed).length/t.length*100)}(a),n=2*Math.PI*38,s=a.filter(e=>!0===e.completed).length,i=a.filter(e=>void 0!==e.completed).length,c=a.filter(e=>e.estimatedTime).reduce((e,t)=>e+(t.estimatedTime||0),0);return(0,r.jsx)("div",{className:"absolute bottom-20 left-1/2 -translate-x-1/2 z-20",style:{pointerEvents:"none"},children:(0,r.jsxs)("div",{className:"flex items-center gap-5 px-6 py-4 rounded-2xl",style:{background:l?"rgba(10,12,20,0.94)":"rgba(255,255,255,0.94)",border:"1px solid ".concat(l?"rgba(245,158,11,0.2)":"rgba(245,158,11,0.15)"),backdropFilter:"blur(16px)",boxShadow:"0 16px 48px rgba(0,0,0,0.25)",pointerEvents:"all"},children:[(0,r.jsxs)("div",{className:"relative flex-shrink-0",children:[(0,r.jsxs)("svg",{width:"90",height:"90",className:"-rotate-90",children:[(0,r.jsx)("defs",{children:(0,r.jsxs)("linearGradient",{id:"planGrad",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[(0,r.jsx)("stop",{offset:"0%",stopColor:"#6366f1"}),(0,r.jsx)("stop",{offset:"100%",stopColor:"#10b981"})]})}),(0,r.jsx)("circle",{cx:"45",cy:"45",r:38,fill:"none",strokeWidth:"8",stroke:l?"rgba(75,85,99,0.25)":"rgba(229,231,235,0.5)"}),(0,r.jsx)("circle",{cx:"45",cy:"45",r:38,fill:"none",strokeWidth:"8",stroke:"url(#planGrad)",strokeLinecap:"round",strokeDasharray:n,strokeDashoffset:n-o/100*n,style:{transition:"stroke-dashoffset 0.6s ease",filter:"drop-shadow(0 0 6px rgba(99,102,241,0.6))"}})]}),(0,r.jsxs)("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[(0,r.jsxs)("div",{className:"text-lg font-black",style:{color:"#6366f1"},children:[o,"%"]}),(0,r.jsx)("div",{className:"text-[9px] font-medium text-gray-500",children:"done"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"font-bold text-sm mb-1",style:{color:l?"#f3f4f6":"#111827"},children:"Today's Plan"}),(0,r.jsxs)("div",{className:"text-xs text-gray-400 mb-3",children:[s,"/",i," tasks \xb7 ",Math.floor(c/60),"h ",c%60,"m"]}),(0,r.jsx)("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1",children:[{label:"Morning",color:"#f59e0b",icon:"\uD83C\uDF05"},{label:"Afternoon",color:"#3b82f6",icon:"☀️"},{label:"Evening",color:"#8b5cf6",icon:"\uD83C\uDF07"},{label:"Someday",color:"#6b7280",icon:"\uD83C\uDF19"}].map(e=>{let t=a.filter(t=>{let l=a.find(e=>e.id===t.parentId);return(null==l?void 0:l.label)===e.label}).length;return(0,r.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,r.jsx)("div",{className:"w-2 h-2 rounded-full flex-shrink-0",style:{background:e.color}}),(0,r.jsxs)("span",{className:"text-[11px]",style:{color:l?"#9ca3af":"#6b7280"},children:[e.icon," ",e.label," (",t,")"]})]},e.label)})})]})]})})}function F(){let{selectedNodeId:e,data:t,updateNode:l,getNodeById:a,activeMode:o}=m(),n=t.settings.darkMode,s=e?a(e):null;if(!s||"goals"!==o||s.isRoot||!s.targetValue)return null;let i=j(s.currentValue||0,s.targetValue),c=2*Math.PI*34;return(0,r.jsx)("div",{className:"absolute right-4 top-4 z-20 w-64",style:{pointerEvents:"all"},children:(0,r.jsxs)("div",{className:"rounded-2xl overflow-hidden shadow-2xl",style:{background:n?"rgba(10,12,20,0.97)":"rgba(255,255,255,0.97)",border:"2px solid ".concat(s.color,"44"),backdropFilter:"blur(16px)"},children:[(0,r.jsxs)("div",{className:"px-4 py-3 flex items-center gap-2",style:{background:"".concat(s.color,"15"),borderBottom:"1px solid ".concat(s.color,"22")},children:[(0,r.jsx)("div",{className:"w-3 h-3 rounded-full",style:{background:s.color,boxShadow:"0 0 8px ".concat(s.color)}}),(0,r.jsx)("span",{className:"font-bold text-sm truncate",style:{color:s.color},children:s.label})]}),(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsx)("div",{className:"flex justify-center mb-4",children:(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsxs)("svg",{width:"84",height:"84",className:"-rotate-90",children:[(0,r.jsx)("circle",{cx:"42",cy:"42",r:34,fill:"none",strokeWidth:"8",stroke:n?"rgba(75,85,99,0.25)":"rgba(229,231,235,0.5)"}),(0,r.jsx)("circle",{cx:"42",cy:"42",r:34,fill:"none",strokeWidth:"8",stroke:s.color,strokeLinecap:"round",strokeDasharray:c,strokeDashoffset:c-i/100*c,style:{transition:"stroke-dashoffset 0.6s ease",filter:"drop-shadow(0 0 8px ".concat(s.color,"99)")}})]}),(0,r.jsx)("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:(0,r.jsxs)("div",{className:"text-2xl font-black",style:{color:s.color},children:[i,"%"]})})]})}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-2 mb-4",children:[(0,r.jsxs)("div",{className:"rounded-xl p-2.5 text-center",style:{background:"".concat(s.color,"15")},children:[(0,r.jsx)("div",{className:"text-xs text-gray-400 mb-0.5",children:"Current"}),(0,r.jsx)("div",{className:"font-black text-base",style:{color:s.color},children:(s.currentValue||0).toLocaleString()})]}),(0,r.jsxs)("div",{className:"rounded-xl p-2.5 text-center",style:{background:n?"rgba(22,25,38,0.5)":"rgba(249,250,251,0.5)"},children:[(0,r.jsx)("div",{className:"text-xs text-gray-400 mb-0.5",children:"Target"}),(0,r.jsx)("div",{className:"font-black text-base",style:{color:n?"#f3f4f6":"#111827"},children:s.targetValue.toLocaleString()})]})]}),(0,r.jsx)("label",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider block mb-1.5",children:"Update Current"}),(0,r.jsx)("input",{type:"number",defaultValue:s.currentValue||0,className:"w-full px-3 py-2 rounded-xl text-sm outline-none",style:{background:n?"rgba(22,25,38,0.8)":"rgba(249,250,251,0.8)",border:"1px solid ".concat(s.color,"44"),color:n?"#f3f4f6":"#111827"},onBlur:e=>l(s.id,{currentValue:Number(e.target.value)}),onKeyDown:e=>{"Enter"===e.key&&l(s.id,{currentValue:Number(e.target.value)})}})]})]})})}function L(){let{selectedNodeId:e,data:t,updateNode:l,getNodeById:a,activeMode:o}=m(),n=t.settings.darkMode,i=e?a(e):null,[c,d]=(0,s.useState)(""),[u,x]=(0,s.useState)("");if((0,s.useEffect)(()=>{d((null==i?void 0:i.notes)||"")},[null==i?void 0:i.id]),!i||"knowledge"!==o||i.isRoot)return null;let b=e=>{let t=e.trim().replace(/^#/,"");if(!t)return;let a=i.tags||[],o=a.includes(t)?a:[...a,t];l(i.id,{tags:o}),x("")},p=e=>{l(i.id,{tags:(i.tags||[]).filter(t=>t!==e)})};return(0,r.jsx)("div",{className:"absolute right-4 top-4 z-20 w-72",style:{pointerEvents:"all"},children:(0,r.jsxs)("div",{className:"rounded-2xl overflow-hidden shadow-2xl",style:{background:n?"rgba(10,12,20,0.97)":"rgba(255,255,255,0.97)",border:"2px solid ".concat(i.color,"44"),backdropFilter:"blur(16px)"},children:[(0,r.jsxs)("div",{className:"px-4 py-3 flex items-center gap-2",style:{background:"".concat(i.color,"15"),borderBottom:"1px solid ".concat(i.color,"22")},children:[(0,r.jsx)("span",{className:"text-base",children:"\uD83D\uDCDD"}),(0,r.jsx)("div",{className:"font-bold text-sm truncate",style:{color:i.color},children:i.label})]}),(0,r.jsxs)("div",{className:"p-4 space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider block mb-1.5",children:"Notes"}),(0,r.jsx)("textarea",{value:c,onChange:e=>d(e.target.value),onBlur:()=>l(i.id,{notes:c}),placeholder:"Write your notes here...",rows:6,className:"w-full resize-none rounded-xl p-3 text-sm outline-none",style:{background:n?"rgba(22,25,38,0.9)":"rgba(249,250,251,0.9)",border:"1px solid ".concat(i.color,"33"),color:n?"#e5e7eb":"#111827",lineHeight:1.6}})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider block mb-1.5",children:"Tags"}),(0,r.jsx)("div",{className:"flex flex-wrap gap-1.5 mb-2 min-h-[24px]",children:(i.tags||[]).map(e=>(0,r.jsxs)("span",{className:"flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium",style:{background:"".concat(i.color,"22"),color:i.color},children:["#",e,(0,r.jsx)("button",{onClick:()=>p(e),className:"leading-none opacity-60 hover:opacity-100 transition-opacity font-bold",children:"\xd7"})]},e))}),(0,r.jsx)("input",{type:"text",placeholder:"Add tag (Enter)…",value:u,onChange:e=>x(e.target.value),onKeyDown:e=>{("Enter"===e.key||","===e.key)&&(e.preventDefault(),b(u))},className:"w-full px-2.5 py-1.5 rounded-lg text-xs outline-none",style:{background:n?"rgba(22,25,38,0.9)":"rgba(249,250,251,0.9)",border:"1px solid ".concat(n?"rgba(75,85,99,0.3)":"rgba(209,213,219,0.5)"),color:n?"#e5e7eb":"#111827"}})]}),(0,r.jsx)("button",{onClick:()=>l(i.id,{notes:c}),className:"w-full py-2 rounded-xl text-sm font-bold text-white transition-all hover:opacity-90 active:scale-95",style:{background:"linear-gradient(135deg, ".concat(i.color,", ").concat(i.color,"cc)"),boxShadow:"0 4px 12px ".concat(i.color,"44")},children:"Save Notes"})]})]})})}let z={urgent:"#ef4444",high:"#f97316",normal:"#6366f1",low:"#6b7280"};function A(){let{data:e,updateNode:t,setSelectedNode:l,deleteNode:a,activeMode:o}=m(),[n,i]=(0,s.useState)(!1),c=e.settings.darkMode;if("tasks"!==o)return null;let d=e.tasks.nodes.filter(e=>!e.isRoot&&e.status);e.tasks.nodes.filter(t=>{var l,a;return!t.isRoot&&!(null===(l=t.parentId)||void 0===l?void 0:l.includes("root"))&&(null===(a=e.tasks.nodes.find(e=>e.isRoot))||void 0===a?void 0:a.id)===t.parentId});let u=[...d].sort((e,t)=>{let l="urgent"===e.priority?4:"high"===e.priority?3:"normal"===e.priority?2:1,a="urgent"===t.priority?4:"high"===t.priority?3:"normal"===t.priority?2:1,o=v(e.deadline)?1:0;return(v(t.deadline)?1:0)-o||a-l}),x=u.filter(e=>"done"===e.status).length,b=u.length?Math.round(x/u.length*100):0;return(0,r.jsxs)("div",{className:"absolute bottom-6 right-6 z-20",style:{pointerEvents:"all"},children:[(0,r.jsxs)("button",{onClick:()=>i(!n),className:"flex items-center gap-2 px-4 py-2.5 rounded-xl font-bold text-sm text-white shadow-lg transition-all hover:scale-105 active:scale-95 mb-2 ml-auto",style:{background:"linear-gradient(135deg, #6366f1, #8b5cf6)",boxShadow:"0 4px 16px rgba(99,102,241,0.4)"},children:[(0,r.jsx)("span",{children:"\uD83D\uDCCB"}),(0,r.jsx)("span",{children:"Task List"}),u.filter(e=>v(e.deadline)&&"done"!==e.status).length>0&&(0,r.jsx)("span",{className:"w-5 h-5 rounded-full bg-red-500 flex items-center justify-center text-[10px] font-black",children:u.filter(e=>v(e.deadline)&&"done"!==e.status).length})]}),n&&(0,r.jsxs)("div",{className:"rounded-2xl overflow-hidden shadow-2xl animate-fade-in",style:{width:320,maxHeight:480,background:c?"rgba(10,12,20,0.97)":"rgba(255,255,255,0.97)",border:"1px solid ".concat(c?"rgba(99,102,241,0.2)":"rgba(99,102,241,0.12)"),backdropFilter:"blur(16px)",display:"flex",flexDirection:"column"},children:[(0,r.jsxs)("div",{className:"px-4 py-3 flex items-center justify-between",style:{background:"linear-gradient(135deg, rgba(99,102,241,0.15), rgba(139,92,246,0.08))",borderBottom:"1px solid rgba(99,102,241,0.15)"},children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"font-bold text-sm",style:{color:"#818cf8"},children:"All Tasks"}),(0,r.jsxs)("div",{className:"text-xs text-gray-400",children:[x,"/",u.length," done \xb7 ",b,"% complete"]})]}),(0,r.jsx)("div",{className:"w-16 h-1.5 rounded-full overflow-hidden",style:{background:"rgba(75,85,99,0.3)"},children:(0,r.jsx)("div",{className:"h-full rounded-full",style:{width:"".concat(b,"%"),background:"linear-gradient(90deg, #6366f1, #10b981)",transition:"width 0.5s ease"}})})]}),(0,r.jsx)("div",{className:"overflow-y-auto flex-1",children:0===u.length?(0,r.jsx)("div",{className:"p-6 text-center text-sm text-gray-500",children:"No tasks yet. Right-click the canvas to add one."}):u.map(e=>{let a=v(e.deadline)&&"done"!==e.status;return(0,r.jsxs)("div",{className:"px-4 py-2.5 border-b flex items-start gap-3 cursor-pointer transition-colors",style:{borderColor:c?"rgba(75,85,99,0.12)":"rgba(229,231,235,0.4)",background:a?"rgba(239,68,68,0.04)":"transparent"},onClick:()=>{l(e.id)},onMouseEnter:e=>e.currentTarget.style.background=c?"rgba(75,85,99,0.1)":"rgba(243,244,246,0.8)",onMouseLeave:e=>e.currentTarget.style.background=a?"rgba(239,68,68,0.04)":"transparent",children:[(0,r.jsx)("button",{className:"w-5 h-5 rounded-full border-2 flex items-center justify-center flex-shrink-0 mt-0.5 transition-all hover:scale-110",style:{borderColor:"done"===e.status?"#10b981":"doing"===e.status?"#f59e0b":"#6b7280",background:"done"===e.status?"#10b981":"transparent"},onClick:l=>{l.stopPropagation(),t(e.id,{status:"done"===e.status?"todo":"done"})},children:"done"===e.status&&(0,r.jsx)("span",{className:"text-white text-[8px] font-black",children:"✓"})}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsx)("div",{className:"text-sm font-medium truncate",style:{color:"done"===e.status?"#6b7280":c?"#e5e7eb":"#111827",textDecoration:"done"===e.status?"line-through":"none"},children:e.label}),(0,r.jsxs)("div",{className:"flex items-center gap-2 mt-0.5",children:[e.priority&&(0,r.jsx)("span",{className:"text-[9px] font-bold uppercase px-1.5 py-0.5 rounded-full",style:{background:"".concat(z[e.priority],"22"),color:z[e.priority]},children:e.priority}),e.deadline&&(0,r.jsx)("span",{className:"text-[10px]",style:{color:a?"#f87171":"#6b7280"},children:k(e.deadline)})]})]}),(0,r.jsx)("div",{className:"w-2 h-2 rounded-full mt-1.5 flex-shrink-0",style:{background:e.color}})]},e.id)})})]})]})}let P={tasks:"✓ Task Board",braindump:"\uD83E\uDDE0 Brain Dump",planner:"\uD83D\uDCC5 Daily Planner",goals:"\uD83C\uDFAF Goal Tracker",knowledge:"\uD83D\uDCDA Knowledge Base"};function V(){let{isSaving:e,lastSaved:t}=function(){let e=m(e=>e.data),[t,l]=(0,s.useState)(null),[a,o]=(0,s.useState)(!1),n=(0,s.useRef)();return(0,s.useEffect)(()=>{if(e.settings.autoSave)return clearTimeout(n.current),n.current=setTimeout(()=>{o(!0),setTimeout(()=>{l(new Date),o(!1)},400)},5e3),()=>clearTimeout(n.current)},[e]),{lastSaved:t,isSaving:a}}(),l=m(e=>e.data.settings.darkMode);if(!e&&!t)return null;let a=t?10>Math.round((Date.now()-t.getTime())/1e3)?"just now":"".concat(Math.round((Date.now()-t.getTime())/1e3),"s ago"):"";return(0,r.jsx)("div",{className:"absolute bottom-6 left-6 flex items-center gap-2 px-3 py-1.5 rounded-xl text-xs z-10",style:{background:l?"rgba(10,12,20,0.9)":"rgba(255,255,255,0.9)",border:"1px solid ".concat(l?"rgba(75,85,99,0.25)":"rgba(229,231,235,0.6)"),backdropFilter:"blur(8px)",color:l?"#6b7280":"#9ca3af"},children:e?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"w-3 h-3 border-2 border-violet-500 border-t-transparent rounded-full animate-spin"}),(0,r.jsx)("span",{children:"Saving…"})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"w-2 h-2 rounded-full bg-emerald-500"}),(0,r.jsxs)("span",{children:["Saved ",a]})]})})}function B(){let{data:e,activeMode:t,selectedNodeId:l}=m(),a=e.settings.darkMode;(0,s.useEffect)(()=>{document.body.style.background=a?"#0a0c14":"#f8fafc",document.body.style.color=a?"#f3f4f6":"#111827"},[a]);let o=("tasks"===t||"planner"===t)&&l;return(0,r.jsxs)("div",{className:"flex flex-col h-full overflow-hidden",style:{background:a?"#0a0c14":"#f8fafc"},children:[(0,r.jsx)(y,{}),(0,r.jsxs)("div",{className:"flex flex-1 overflow-hidden min-h-0",children:[(0,r.jsx)(w,{}),(0,r.jsxs)("main",{className:"flex-1 relative overflow-hidden min-w-0",children:[(0,r.jsx)(S,{}),"braindump"===t&&(0,r.jsx)(R,{}),"planner"===t&&(0,r.jsx)(O,{}),"knowledge"===t&&l&&(0,r.jsx)(L,{}),"goals"===t&&l&&(0,r.jsx)(F,{}),o&&(0,r.jsx)(E,{}),(0,r.jsx)(A,{}),(0,r.jsx)(V,{}),(0,r.jsx)("div",{className:"absolute top-4 left-4 px-3 py-1.5 rounded-full text-xs font-bold z-10 select-none",style:{background:a?"rgba(10,12,20,0.85)":"rgba(255,255,255,0.85)",border:"1px solid rgba(99,102,241,0.25)",color:"#818cf8",backdropFilter:"blur(8px)",boxShadow:"0 2px 8px rgba(99,102,241,0.15)"},children:P[t]})]})]}),(0,r.jsx)(T,{})]})}}},function(e){e.O(0,[971,117,744],function(){return e(e.s=8210)}),_N_E=e.O()}]);